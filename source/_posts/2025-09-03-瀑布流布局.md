---
title: ç€‘å¸ƒæµå¸ƒå±€
date: 2025-09-03 15:19:04
tags:
  - ç€‘å¸ƒæµå¸ƒå±€
  - css
categories: Javascript
cover: /images/ç€‘å¸ƒæµå¸ƒå±€/cover.jpg # å°é¢å›¾
---

ç€‘å¸ƒæµå¸ƒå±€ï¼ˆWaterfall Layoutï¼‰æ˜¯ä¸€ç§æµè¡Œçš„ç½‘é¡µå¸ƒå±€æ–¹å¼ï¼Œæ ¸å¿ƒç‰¹ç‚¹æ˜¯ä¸è§„åˆ™çš„å¤šåˆ—ç½‘æ ¼ç»“æ„ â€”â€” æ¯åˆ—ä¸­çš„å†…å®¹å—é«˜åº¦ä¸åŒï¼Œå†…å®¹å—ä¼šåƒç€‘å¸ƒæµæ°´ä¸€æ ·ï¼Œè‡ªåŠ¨å¡«å……åˆ°å½“å‰é«˜åº¦æœ€ä½çš„åˆ—ä¸­ï¼Œæœ€ç»ˆå½¢æˆé”™è½æœ‰è‡´ã€è§†è§‰ä¸°å¯Œçš„å¸ƒå±€æ•ˆæœã€‚å®ƒå¹¿æ³›åº”ç”¨äºå›¾ç‰‡å±•ç¤ºã€å•†å“åˆ—è¡¨ã€å†…å®¹å¡ç‰‡ç­‰åœºæ™¯ï¼ˆå¦‚ Pinterestã€Unsplashã€å°çº¢ä¹¦çš„é¦–é¡µ / æœç´¢é¡µï¼‰ã€‚

### ğŸ”¥ CSS Grid å®ç°ï¼ˆç®€å•é«˜æ•ˆï¼‰

- CSS Grid çš„ grid-template-rows: masonryï¼ˆç –çŸ³å¸ƒå±€ï¼‰ç‰¹æ€§ï¼Œè¿™æ˜¯ CSS åŸç”Ÿæ”¯æŒçš„ç€‘å¸ƒæµæ–¹æ¡ˆï¼Œæ— éœ€ JS è®¡ç®—ã€‚
  - ä¼˜ç‚¹: çº¯ CSS å®ç°ï¼Œä»£ç ç®€æ´ï¼Œæ€§èƒ½ä¼˜å¼‚ï¼Œè‡ªåŠ¨é€‚åº”å®¹å™¨å®½åº¦
  - ç¼ºç‚¹: æµè§ˆå™¨å…¼å®¹æ€§æœ‰é™ï¼ˆChrome 87+ã€Firefox 77+ æ”¯æŒï¼ŒSafari æš‚ä¸æ”¯æŒï¼‰
  - é€‚ç”¨åœºæ™¯: å¯¹å…¼å®¹æ€§è¦æ±‚ä¸é«˜çš„ç°ä»£ç½‘ç«™ï¼Œå¿«é€Ÿå®ç°ç€‘å¸ƒæµ

```html
<template>
	<div class="waterfall">
		<div
			class="item"
			v-for="it in 30"
			:key="it"
			:style="{ '--w': '250px', '--h': Math.floor(Math.random() * 5) * 50 + 'px' }"
		>
			{{ it }} Â  Â  Â  Â 
		</div>
	</div>
</template>

<style lang="less" scoped>
	/**
	Â  * grid-template-rows: masonry
	Â  * CSS Grid å¸ƒå±€ä¸­ä¸€ä¸ªç‰¹æ®Šçš„å®éªŒæ€§å€¼ï¼Œç”¨äºå®ç°ç –çŸ³å¸ƒå±€ï¼ˆç€‘å¸ƒæµæ•ˆæœï¼‰ã€‚(è¿˜æœ‰å…¶ä»–å®éªŒæ€§å€¼ï¼Œå¦‚ masonry-rows)
	Â  * ã€æ•ˆæœã€‘å…ƒç´ ä¼šæŒ‰åˆ—æ’åˆ—ï¼Œæ¯åˆ—çš„é«˜åº¦æ ¹æ®å†…å®¹è‡ªåŠ¨è°ƒæ•´ï¼Œæ–°å…ƒç´ ä¼˜å…ˆå¡«å……åˆ°å½“å‰æœ€çŸ­çš„åˆ—ï¼Œå½¢æˆå…¸å‹çš„ç€‘å¸ƒæµè§†è§‰æ•ˆæœã€‚
	Â  * ã€å…¼å®¹æ€§ä¸é™åˆ¶ã€‘ç›®å‰åœ¨ Firefox å’Œ Chrome ä¸­æ”¯æŒï¼Œä½†éœ€è¦å¼€å¯å®éªŒæ€§åŠŸèƒ½ã€‚
	Â  * ã€æ³¨æ„ã€‘ç”±äºæ˜¯å®éªŒæ€§ç‰¹æ€§ï¼Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨éœ€è°¨æ…ï¼Œå»ºè®®ä½œä¸ºæ¸è¿›å¢å¼ºæ–¹æ¡ˆã€‚
	Â */
	.waterfall {
	Â  Â  display: grid;
	Â  Â  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); /* æ¯åˆ—æœ€å° 250pxï¼Œæœ€å¤§è‡ªé€‚åº”ï¼ˆ1frï¼‰ï¼Œè‡ªåŠ¨å¡«å……åˆ—æ•° */
	Â  Â  grid-template-rows: masonry; /* å…³é”®ï¼šå¯ç”¨ç –çŸ³å¸ƒå±€ï¼Œã€è‡ªåŠ¨å¡«å……æœ€çŸ­åˆ—ã€‘ */
	Â  Â  gap: 10px; /* é—´è· */
	}
	.item {
	    break-inside: avoid; /* é˜²æ­¢å†…å®¹è¢«åˆ†å‰² */
	Â  Â  // width: var(--w);
	Â  Â  height: calc(var(--h) + 200px);
	Â  Â  background: blue;
	Â  Â  border-radius: 10px;
	Â  Â  border: 1px solid #ccc;
	Â  Â  display: flex;
	Â  Â  align-items: center;
	Â  Â  justify-content: center;
	Â  Â  font-size: 30px;
	Â  Â  color: #fff;
	}
</style>
```

- æ•ˆæœï¼š(æˆ‘å¼€å¯äº†å®éªŒæ€§åŠŸèƒ½æ”¯æŒï¼Œmasonry ç –çŸ³å¸ƒå±€å¥½åƒä¹Ÿæ²¡æœ‰ç”Ÿæ•ˆ???)
  ![](/images/ç€‘å¸ƒæµå¸ƒå±€/waterfall1.png)
- å¼€å¯è°·æ­Œå¼€å¯å®éªŒæ€§åŠŸèƒ½ï¼šæ‰“å¼€æµè§ˆï¼Œè¾“å…¥ chrome://flags/å›è½¦ -> è¾“å…¥å®éªŒæ€§åŠŸèƒ½çš„å…³é”®è¯æœç´¢ -> å¯ç”¨ Enable
  ![](/images/ç€‘å¸ƒæµå¸ƒå±€/chrome.png)

### ğŸ”¥ CSS å¤šåˆ—å¸ƒå±€ï¼Œåˆ©ç”¨ CSS çš„ columns å¤šåˆ—å±æ€§ï¼Œå°†å†…å®¹æŒ‰åˆ—åˆ†å‰²ï¼Œè‡ªåŠ¨å¡«å……é«˜åº¦

- ä¼˜ç‚¹ï¼šçº¯ CSS å®ç°ï¼Œå…¼å®¹æ€§è¾ƒå¥½ï¼ˆIE10+ æ”¯æŒï¼‰ï¼Œä»£ç ç®€å•
- ç¼ºç‚¹ï¼šå†…å®¹æŒ‰ â€œåˆ—â€ é¡ºåºæ’åˆ—ï¼ˆè€Œéè¡Œï¼‰ï¼Œæ»šåŠ¨åŠ è½½æ—¶å¯èƒ½éœ€è¦é‡æ–°æ’åºï¼›åˆ—å®½å›ºå®šï¼ŒåŠ¨æ€è°ƒæ•´åˆ—æ•°éœ€é¢å¤–å¤„ç†
- é€‚ç”¨åœºæ™¯ï¼šé™æ€å†…å®¹å±•ç¤ºï¼Œå¯¹æ’åºé¡ºåºè¦æ±‚ä¸é«˜çš„åœºæ™¯ï¼ˆå¦‚ï¼šå›¾ç‰‡å¢™ï¼‰

```html
<template>
	<div class="waterfall">
		<div
			class="item"
			v-for="it in 13"
			:key="it"
			:style="{ '--w': '250px', '--h': Math.floor(Math.random() * 5) * 50 + 'px' }"
		>
			{{ it }}
		</div>
	</div>
</template>

<style lang="less" scoped>
	.waterfall {
	Â  Â  width: 100%;
	Â  Â  height: unset;
	Â  Â  columns: 5; Â /* åˆ—æ•° */
	    column-gap: 10px; Â /* åˆ—é—´è· */
	Â  Â  padding: 30px;
	}
	.item {
	Â  Â  break-inside: avoid; /* é˜²æ­¢å†…å®¹è¢«åˆ†å‰² */
	    margin-bottom: 10px; Â /* é¡¹é—´è· */
	Â  Â  // width: var(--w); Â /* æœªè®¾ç½®å®½ï¼Œåˆ™å…ƒç´ å®½åº¦æŒ‰ç…§5åˆ—å¹³åˆ† */
	Â  Â  height: calc(var(--h) + 200px);
	Â  Â  background: blue;
	Â  Â  border-radius: 10px;
	Â  Â  border: 1px solid #ccc;
	Â  Â  display: flex;
	Â  Â  align-items: center;
	Â  Â  justify-content: center;
	Â  Â  font-size: 30px;
	Â  Â  color: #fff;
	}
</style>
```

- æ•ˆæœï¼š
  ![](/images/ç€‘å¸ƒæµå¸ƒå±€/waterfall2.png)

### ğŸ”¥ JavaScript åŠ¨æ€è®¡ç®—ï¼ˆæœ€çµæ´»ï¼Œå…¼å®¹æ€§å¥½ï¼‰

- ä¼˜ç‚¹: å®Œå…¨å¯æ§ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½ã€å“åº”å¼è°ƒæ•´åˆ—æ•°ï¼Œå…¼å®¹æ€§æä½³ï¼ˆæ‰€æœ‰æµè§ˆå™¨ï¼‰
- ç¼ºç‚¹: éœ€è¦ JavaScript å‚ä¸ï¼Œåˆå§‹åŠ è½½å’Œæ»šåŠ¨åŠ è½½æ—¶éœ€è®¡ç®—ï¼Œå¤æ‚åº¦ç•¥é«˜
- é€‚ç”¨åœºæ™¯: åŠ¨æ€å†…å®¹ï¼ˆå¦‚æ— é™æ»šåŠ¨ï¼‰ã€å¯¹æ’åºå’Œå…¼å®¹æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼ˆå¦‚ç”µå•†å•†å“åˆ—è¡¨ï¼‰

```html
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>ç€‘å¸ƒæµå¸ƒå±€</title>
		<style>
			.waterfall {
			Â    display: flex;
			Â  Â  gap: 16px; Â /* åˆ—é—´è· */
			Â  Â  padding: 20px;
			Â  Â  /* align-items: flex-startè®©å­å…ƒç´ é«˜åº¦ç”±è‡ªèº«å†…å®¹å†³å®šï¼Œä¸éšå­å…ƒç´ ä¸­çš„æœ€é«˜å…ƒç´ æ‹‰ä¼¸ */
			Â  Â  align-items: flex-start;
			}
			.column {
			Â  Â  flex: 1;
			Â  Â  display: flex;
			Â  Â  flex-direction: column;
			Â  Â  gap: 16px; Â /* å…ƒç´ é—´è· */
			}
			.item {
			Â  Â  width: 100%;
			Â  Â  background: blue;
			Â  Â  border-radius: 10px;
			Â  Â  border: 1px solid #ccc;
			Â  Â  display: flex;
			Â  Â  align-items: center;
			Â  Â  justify-content: center;
			Â  Â  font-size: 30px;
			Â  Â  color: #fff;
			}
		</style>
	</head>
	<body>
		<div class="waterfall" id="waterfall"></div>
	</body>
	Â  Â 
	<script>
		// åˆå§‹åŒ–åˆ—
		const columnCount = 5 // åˆ—æ•°
		const waterfall = document.getElementById('waterfall')
		for (let i = 0; i < columnCount; i++) {
			const column = document.createElement('div')
			column.className = 'column'
			waterfall.appendChild(column)
		}
		const columns = document.querySelectorAll('.column')

		// æ·»åŠ å…ƒç´ åˆ°æœ€çŸ­åˆ—
		function addItem(content, height) {
			// æ‰¾åˆ°é«˜åº¦æœ€å°çš„åˆ—
			let shortestColumn = columns[0]
			columns.forEach((col) => {
				window.console.log(col.offsetHeight, shortestColumn.offsetHeight)
				if (col.offsetHeight < shortestColumn.offsetHeight) {
					shortestColumn = col
				}
			})
			// åˆ›å»ºå…ƒç´ å¹¶æ·»åŠ åˆ°æœ€çŸ­åˆ—
			const item = document.createElement('div')
			item.className = 'item'
			item.style.height = `${height}px` // æ¨¡æ‹Ÿä¸åŒé«˜åº¦
			item.innerHTML = content
			shortestColumn.appendChild(item)
		}

		// æ¨¡æ‹Ÿæ·»åŠ å†…å®¹
		for (let i = 0; i < 20; i++) {
			const randomHeight = Math.floor(Math.random() * 300) + 120 // 120-420px éšæœºé«˜åº¦
			addItem(`box ${i + 1}`, randomHeight)
		}
	</script>
</html>
```

- æ•ˆæœï¼š
  ![](/images/ç€‘å¸ƒæµå¸ƒå±€/waterfall3.png)

### ğŸ”¥ ç¬¬ä¸‰æ–¹åº“å®ç°ï¼ˆå¿«é€Ÿå¼€å‘ï¼‰

ä½¿ç”¨æˆç†Ÿçš„ç€‘å¸ƒæµåº“ï¼Œå‡å°‘é‡å¤å¼€å‘ï¼Œå¸¸è§åº“åŒ…æ‹¬ï¼š

- Masonryï¼ˆæœ€æµè¡Œï¼‰https://masonry.desandro.com

  - ç‰¹ç‚¹ï¼šè½»é‡ã€çµæ´»ï¼Œæ”¯æŒåŠ¨ç”»å’Œå“åº”å¼ï¼Œéœ€é…åˆ jQuery æˆ–ç‹¬ç«‹ä½¿ç”¨

- Isotopeï¼šhttps://isotope.metafizzy.co

  - ç‰¹ç‚¹ï¼šæ”¯æŒç€‘å¸ƒæµã€æ’åºã€è¿‡æ»¤ç­‰åŠŸèƒ½ï¼ŒåŠŸèƒ½æ›´å…¨é¢ï¼Œä½†ä½“ç§¯ç¨å¤§ã€‚

ä¸‹è½½ä¾èµ–ï¼š`npm install masonry-layout -D` æˆ– `npm install isotope-layout -D`

ä»£ç å¦‚ä¸‹ï¼š(ä¸¤ä¸ªæ’ä»¶åº“ä½¿ç”¨æ–¹æ³•ç›¸ä¼¼)

```html
<template>
	<div class="grid">
		<div
			class="grid-item"
			v-for="it in 15"
			:key="it"
			:style="{ '--w': '300px', '--h': Math.random() * 200 + 'px' }"
		>
			{{ it }} Â  Â  Â  Â 
		</div>
	</div>
</template>
<script setup>
	import { onMounted } from 'vue'
	import * as Masonry from 'masonry-layout'
	// import * as Isotope from 'isotope-layout';
	onMounted(() => {
		const grid = document.querySelector('.grid')
		if (grid) {
			new Masonry(grid, {
				itemSelector: '.grid-item',
				columnWidth: '.grid-item',
				percentPosition: true,
				gutter: 10, // åˆ—é—´è·
			})
		}
	})
</script>
<style lang="less" scoped>
	.grid {
	Â  Â  background-color: #999;
	Â  Â  .grid-item {
	Â  Â  Â  Â  width: var(--w);
	Â  Â  Â  Â  height: calc(var(--h) + 120px); Â /* 120-320px */
	Â  Â  Â  Â  background-color: blue;
	Â  Â  Â  Â  border-radius: 10px;
	Â  Â  Â  Â  border: 1px solid #ccc;
	Â  Â  Â  Â  margin-bottom: 10px; Â /* å…ƒç´ é—´è· */
	Â  Â  Â  Â  display: flex;
	Â  Â  Â  Â  align-items: center;
	Â  Â  Â  Â  justify-content: center;
	Â  Â  Â  Â  font-size: 30px;
	Â  Â  Â  Â  color: #fff;
	Â  Â  }
	}
</style>
```

- æ•ˆæœï¼š
  ![](/images/ç€‘å¸ƒæµå¸ƒå±€/waterfall4.png)

ã€æ€»ç»“ã€‘

- å¿«é€Ÿå®ç°ä¸”å…¼å®¹æ€§è¦æ±‚ä¸é«˜ â†’ é€‰ CSS Grid ç –çŸ³å¸ƒå±€ã€‚
- å…¼å®¹æ€§ä¼˜å…ˆä¸”å†…å®¹é™æ€ â†’ é€‰ CSS å¤šåˆ—å¸ƒå±€ã€‚
- åŠ¨æ€å†…å®¹æˆ–å¤æ‚äº¤äº’ â†’ é€‰ JavaScript è®¡ç®— æˆ– ç¬¬ä¸‰æ–¹åº“ã€‚

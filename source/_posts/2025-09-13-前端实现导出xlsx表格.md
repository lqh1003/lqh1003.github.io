---
title: å‰ç«¯å®ç°å¯¼å‡ºxlsxè¡¨æ ¼
date: 2025-09-13 10:08:19
tags:
  - export
  - xlsx
categories: ä¸Šä¼ /å¯¼å‡º
cover: /images/å‰ç«¯å®ç°å¯¼å‡ºxlsxè¡¨æ ¼/cover.jpg # å°é¢å›¾
---

å‰ç«¯æ ¹æ®åç«¯æ¥å£è¿”å›çš„æ•°æ®ï¼ˆæ•°ç»„ / æ–‡ä»¶æœ¬èº« / é“¾æ¥ï¼‰åšå¯¹åº”çš„ä¸‹è½½å¤„ç†ï¼š

### ğŸ‘‰ æ ¹æ®æ¥å£è¿”å›çš„æ•°æ®æ•°ç»„(è¡¨æ ¼/åˆ—è¡¨æ•°æ®)ï¼Œå‰ç«¯è‡ªå·±å®ç° excel è¡¨æ ¼ä¸‹è½½

**ï¼ˆ1ï¼‰ä¸‹è½½ä¾èµ–**

```bash
npm install xlsx file-saver
```

**ï¼ˆ2ï¼‰ç¼–å†™ä¿å­˜å‡½æ•° htmlToExcel.js**

```javascript
import FileSaver, { saveAs } from 'file-saver'
import * as XLSX from 'xlsx'
import { ElMessage } from 'element-plus'

export default {
	downloadXlsx(dataList, fileName, wscols) {
		try {
			const stringToBuff = (str) => {
				let buf = new ArrayBuffer(str.length)
				let view = new Uint8Array(buf)
				for (let i = 0; i !== str.length; ++i) {
					view[i] = str.charCodeAt(i) & 0xff
				}
				return buf
			}
			// åˆ›å»ºå·¥ä½œç°¿
			let workbook = XLSX.utils.book_new()
			// å°†æ•°æ®è½¬æ¢ä¸ºå·¥ä½œè¡¨
			let worksheet = XLSX.utils.aoa_to_sheet(dataList)
			// è®¾ç½®å¯¼å‡ºè¡¨æ ¼æ¯ä¸€åˆ—çš„å®½
			if (wscols) worksheet['!cols'] = wscols
			// å°†å·¥ä½œè¡¨æ·»åŠ åˆ°å·¥ä½œç°¿
			XLSX.utils.book_append_sheet(workbook, worksheet, 'sheet1')

			// åˆ›å»ºäºŒè¿›åˆ¶å¯¹è±¡å†™å…¥è½¬æ¢å¥½çš„å­—èŠ‚æµ
			let xlsxBlob = new Blob(
				[
					stringToBuff(
						XLSX.write(workbook, {
							bookType: 'xlsx',
							bookSST: false,
							type: 'binary',
						})
					),
				],
				{ type: '' }
			)
			// ä¸‹è½½å¯¼å‡ºçš„æ–‡ä»¶
			FileSaver.saveAs(xlsxBlob, fileName + '.xlsx')
			ElMessage({ type: 'success', message: 'å¯¼å‡ºæˆåŠŸ' })
		} catch (e) {
			console.error(e)
			ElMessage.error('å¯¼å‡ºå¤±è´¥')
		}
	},

	/** åŠ ä¸Š xlsxParam å¯ä»¥è§£å†³å¯¼å‡ºçš„è¡¨æ ¼æ•°æ®é”™è¯¯çš„é—®é¢˜,æ¯”å¦‚ä»¥ä¸‹å„ç§æƒ…å†µç­‰:
	 * èº«ä»½è¯å·ï¼š 5.23E+17
	 * æ—¥æœŸæ ¼å¼è¢«è¡¥å…¨åˆ°æ—¶åˆ†ç§’
	 * 3% -> Â 0.03
	 * '1-7' -> 2001/1/7
	 */
	getExcel(dom, fileName) {
		let xlsxParam = { raw: true }
		const domDu = document.querySelector(dom)
		// let worksheet = XLSX.utils.table_to_book(domDu)
		let worksheet = XLSX.utils.table_to_book(domDu, xlsxParam)
		let worksheetout = XLSX.write(worksheet, {
			bookType: 'xlsx',
			bookSST: true,
			type: 'array',
		})
		try {
			FileSaver.saveAs(
				new Blob([worksheetout], { type: 'application/octet-stream' }),
				fileName
			)
			ElMessage({ type: 'success', message: 'å¯¼å‡ºæˆåŠŸ' })
		} catch (e) {
			console.error(e)
			ElMessage.error('å¯¼å‡ºå¤±è´¥')
		}
		return worksheetout
	},
}
```

**ï¼ˆ3ï¼‰ç›´æ¥ä½¿ç”¨**

```md
<el-table ref="reportRef" v-loading="loading" :data="dataList" id="exportTable">...</el-table>

<script setup>
import download from '@/utils/htmlToExcel.js'
const loading = ref(false)
const dataList = ref([])
const getDataList = () => {}

// ä½¿ç”¨æ–¹æ³•1
const handleExport = () => {
Â  Â  let list = [
Â  Â  Â  Â  [
Â  Â  Â  Â  Â  Â  "å§“å",
Â  Â  Â  Â  Â  Â  "å¹´é¾„",
Â  Â  Â  Â  Â  Â  "æ€§åˆ«",
Â  Â  Â  Â  Â  Â  "å­¦å†",
Â  Â  Â  Â  Â  Â  "åˆ›å»ºæ—¶é—´",
Â  Â  Â  Â  ],
Â  Â  ];
Â  Â  dataList.value.forEach((item, index) => {
Â  Â  Â  Â  list.push([
Â  Â  Â  Â  Â  Â  item.name,
Â  Â  Â  Â  Â  Â  item.age,
Â  Â  Â  Â  Â  Â  item.sex,
Â  Â  Â  Â  Â  Â  item.education,
Â  Â  Â  Â  Â  Â  item.createTime,
Â  Â  Â  Â  ]);
Â  Â  });
Â  Â  download.downloadXlsx(list, `2023-12-01.xlsx`);
}

// ä½¿ç”¨æ–¹æ³•2ï¼Œ é€‚ç”¨äºå¤æ‚çš„è¡¨æ ¼ (å•å…ƒæ ¼åˆå¹¶ç­‰æƒ…å†µ)
const handleExport = () => {
Â  Â  download.getExcel('#exportTable', `2023-12-01.xlsx`)
}
</script>
```

### ğŸ‘‰ æ¥å£ç›´æ¥è¿”å›æ–‡ä»¶ï¼Œå®ç° excel è¡¨æ ¼ä¸‹è½½

- æ¥å£è¿”å›

```javascript
// http.js
import request from '@/utils/request'
export function exportVarTestReport(data) {
	return request({
		url: '/app-api/website/calc/download',
		method: 'get',
		params: data,
		responseType: 'blob',
		headers: {
			'Content-Type': 'application/x-www-form-urlencoded',
		},
	})
}
```
<img src="/images/å‰ç«¯å®ç°å¯¼å‡ºxlsxè¡¨æ ¼/exportFile1.png" alt="image" class="max600"/>
<img src="/images/å‰ç«¯å®ç°å¯¼å‡ºxlsxè¡¨æ ¼/exportFile2.png" alt="image" class="max600"/>

- å¤„ç†æ•°æ®(ä¸‹è½½)

```javascript
// ä¸‹è½½æŠ¥å‘Šæ“ä½œ
function downloadReport(row) {
	try {
		exportReport({
			id: row.id,
		})
			.then((res) => {
				// å¤„ç†æ•´ä¸ªæ–‡ä»¶res.data
				// ******** å¼€å§‹ ********
				const link = document.createElement('a')
				const blogObj = new Blob([res.data], {
					type: 'application/vnd.ms-excel',
				})
				// åˆ›å»ºä¸€ä¸ªæ–°çš„urlå¯¹è±¡
				const objectUrl = window.URL.createObjectURL(blogObj)
				link.href = objectUrl
				// å¯¼å‡ºæ–‡ä»¶å
				link.download = `result.xlsx`
				// è‡ªå®šä¹‰ä¸‹è½½æ–‡ä»¶å
				link.click()
				// ä¸ºäº†æ›´å¥½åœ°æ€§èƒ½å’Œå†…å­˜ä½¿ç”¨çŠ¶å†µï¼Œåº”è¯¥åœ¨é€‚å½“çš„æ—¶å€™é‡Šæ”¾url
				window.URL.revokeObjectURL(objectUrl)
				// ******** ç»“æŸ ********
			})
			.catch(() => {
				console.log('ä¸‹è½½å¤±è´¥')
			})
			.finally(() => {})
	} catch (error) {}
}
```

### ğŸ‘‰ æ¥å£è¿”å›ä¸€ä¸ªæ–‡ä»¶é“¾æ¥ï¼Œå®ç°ç‚¹å‡»æŒ‰é’®ä¸‹è½½

```javascript
const href = 'http: xxxxx'
clickDownFile('name', href)

// ç‚¹å‡»æŒ‰é’®ä¸‹è½½
function clickDownFile(filename, href) {
	const a = document.createElement('a')
	a.href = href // aé“¾æ¥çš„ä¸‹è½½åœ°å€
	a.setAttribute('download', filename)
	document.body.appendChild(a)
	a.click()
	document.body.removeChild(a)
	window.URL.revokeObjectURL(href)
}
```
